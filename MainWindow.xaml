<Window x:Class="PhageVirus.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PhageVirus - Advanced EDR System" 
        Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="{StaticResource PrimaryBackground}">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header Section -->
        <Border Grid.Row="0" 
                Background="{StaticResource CardGradient}"
                BorderBrush="{StaticResource BorderPrimary}"
                BorderThickness="0,0,0,1"
                Padding="30,20">
            <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
                <!-- Title and Subtitle -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="PHAGEVIRUS" 
                               FontSize="32" 
                               FontWeight="800" 
                               Foreground="{StaticResource AccentPrimary}"
                               FontFamily="Segoe UI"/>
                    <TextBlock Text="Advanced Endpoint Detection &amp; Response System" 
                               FontSize="14" 
                               Foreground="{StaticResource TextSecondary}"
                               Margin="0,5,0,0"
                               FontWeight="400"/>
                </StackPanel>
            
            <!-- Module Status Indicators -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="SYSTEM STATUS" 
                               Foreground="{StaticResource TextSecondary}" 
                               VerticalAlignment="Center" 
                               Margin="0,0,15,0"
                               FontSize="12"
                               FontWeight="600"/>
                    <Ellipse x:Name="VirusHunterStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="PayloadReplacerStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="ProcessWatcherStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="AutorunBlockerStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="MemoryTrapStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="CredentialTrapStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="ExploitShieldStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="WatchdogStatus" Style="{StaticResource PulseIndicator}"/>
                    <Ellipse x:Name="RedTeamAgentStatus" Style="{StaticResource PulseIndicator}"/>
            </StackPanel>
        </Grid>
        </Border>
        
        <!-- Metrics Dashboard -->
        <Border Grid.Row="1" 
                Background="Transparent"
                Padding="30,20">
            <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Active Threats -->
                <Border Grid.Column="0" Style="{StaticResource MetricCard}">
                <StackPanel>
                        <TextBlock x:Name="ActiveThreatsValue" Text="0" Style="{StaticResource MetricValue}"/>
                        <TextBlock Text="Active Threats" Style="{StaticResource MetricLabel}"/>
                </StackPanel>
            </Border>
            
            <!-- Prevented Attacks -->
                <Border Grid.Column="1" Style="{StaticResource MetricCard}">
                <StackPanel>
                        <TextBlock x:Name="PreventedAttacksValue" Text="0" Style="{StaticResource MetricValue}"/>
                        <TextBlock Text="Prevented Attacks" Style="{StaticResource MetricLabel}"/>
                </StackPanel>
            </Border>
            
            <!-- CPU Usage -->
                <Border Grid.Column="2" Style="{StaticResource MetricCard}">
                <StackPanel>
                        <TextBlock x:Name="CpuUsageValue" Text="0%" Style="{StaticResource MetricValue}"/>
                        <TextBlock Text="CPU Usage" Style="{StaticResource MetricLabel}"/>
                </StackPanel>
            </Border>
            
            <!-- Memory Usage -->
                <Border Grid.Column="3" Style="{StaticResource MetricCard}">
                <StackPanel>
                        <TextBlock x:Name="MemoryUsageValue" Text="0 MB" Style="{StaticResource MetricValue}"/>
                        <TextBlock Text="Memory Usage" Style="{StaticResource MetricLabel}"/>
                </StackPanel>
            </Border>
            
            <!-- Time Since Last Threat -->
                <Border Grid.Column="4" Style="{StaticResource MetricCard}">
                <StackPanel>
                        <TextBlock x:Name="LastThreatValue" Text="0s" Style="{StaticResource MetricValue}"/>
                        <TextBlock Text="Last Threat" Style="{StaticResource MetricLabel}"/>
                </StackPanel>
            </Border>
            
            <!-- System Health -->
                <Border Grid.Column="5" Style="{StaticResource MetricCard}">
                <StackPanel>
                        <TextBlock x:Name="SystemHealthValue" Text="100%" Style="{StaticResource MetricValue}"/>
                        <TextBlock Text="System Health" Style="{StaticResource MetricLabel}"/>
                </StackPanel>
            </Border>
        </Grid>
        </Border>
        
        <!-- Action Bar - Prominent Functionality Buttons -->
        <Border Grid.Row="2" 
                Background="{StaticResource CardGradient}"
                BorderBrush="{StaticResource BorderPrimary}"
                BorderThickness="0,1,0,1"
                Padding="30,15">
            <StackPanel>
                <TextBlock Text="QUICK ACTIONS" 
                           Foreground="{StaticResource AccentPrimary}" 
                           FontWeight="600" 
                           FontSize="16" 
                           Margin="0,0,0,15"
                           HorizontalAlignment="Center"/>
                
                <WrapPanel HorizontalAlignment="Center">
                    <!-- Core Hunting Buttons -->
                    <Button x:Name="QuickStartHuntingButton" Content="ðŸš€ START HUNTING" 
                            Style="{StaticResource SuccessButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="StartHunting_Click"/>
                    
                    <Button x:Name="QuickStopHuntingButton" Content="â¹ï¸ STOP HUNTING" 
                            Style="{StaticResource WarningButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="StopHunting_Click"/>
                    
                    <!-- Advanced Features -->
                    <Button x:Name="QuickBehaviorTestButton" Content="ðŸ§ª BEHAVIOR TEST" 
                            Style="{StaticResource PrimaryButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="StartBehaviorTest_Click"/>
                    
                    <Button x:Name="QuickDiagnosticButton" Content="ðŸ” DIAGNOSTIC TEST" 
                            Style="{StaticResource ModernButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="QuickDiagnosticButton_Click"/>
                    
                    <Button x:Name="QuickLogViewerButton" Content="ðŸ“‹ LOG VIEWER" 
                            Style="{StaticResource ModernButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="OpenLogViewer_Click"/>
                    
                    <Button x:Name="QuickExportLogButton" Content="ðŸ“¤ EXPORT LOGS" 
                            Style="{StaticResource ModernButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="ExportLog_Click"/>
            
                    <!-- System Management -->
                    <Button x:Name="QuickRefreshButton" Content="ðŸ”„ REFRESH" 
                            Style="{StaticResource ModernButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="Refresh_Click"/>
                    
                    <Button x:Name="QuickSelfDestructButton" Content="ðŸ’¥ SELF-DESTRUCT" 
                            Style="{StaticResource DangerButton}"
                            Padding="25,12" 
                            Margin="5" 
                            FontSize="14"
                            FontWeight="600"
                            Click="SelfDestruct_Click"/>
                </WrapPanel>
            </StackPanel>
        </Border>
        
        <!-- Main Content Area -->
        <TabControl Grid.Row="3" 
                    Background="Transparent" 
                    BorderThickness="0"
                    Margin="30,0,30,0">
            
            <!-- Threat Intelligence -->
            <TabItem Header="THREAT INTELLIGENCE">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="200"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Threat Statistics -->
                    <Grid Grid.Row="0" Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border Grid.Column="0" Style="{StaticResource MetricCard}">
                            <StackPanel>
                                <TextBlock x:Name="CredentialAttacksValue" Text="0" Style="{StaticResource MetricValue}"/>
                                <TextBlock Text="Credential Attacks" Style="{StaticResource MetricLabel}"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="1" Style="{StaticResource MetricCard}">
                            <StackPanel>
                                <TextBlock x:Name="ExploitsNeutralizedValue" Text="0" Style="{StaticResource MetricValue}"/>
                                <TextBlock Text="Exploits Neutralized" Style="{StaticResource MetricLabel}"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="2" Style="{StaticResource MetricCard}">
                            <StackPanel>
                                <TextBlock x:Name="PersistenceEntriesValue" Text="0" Style="{StaticResource MetricValue}"/>
                                <TextBlock Text="Persistence Entries" Style="{StaticResource MetricLabel}"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="3" Style="{StaticResource MetricCard}">
                            <StackPanel>
                                <TextBlock x:Name="TotalThreatsValue" Text="0" Style="{StaticResource MetricValue}"/>
                                <TextBlock Text="Total Threats" Style="{StaticResource MetricLabel}"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                    
                    <!-- Threat Timeline -->
                    <GroupBox Grid.Row="1" Header="THREAT TIMELINE" Margin="0,0,0,20">
                        <DataGrid x:Name="ThreatTimelineGrid" 
                                  Style="{StaticResource ModernDataGrid}"
                                  Height="200">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Timestamp" 
                                                    Binding="{Binding Timestamp}" 
                                                    Width="150" 
                                                    FontFamily="Consolas"/>
                                <DataGridTextColumn Header="Threat Type" 
                                                    Binding="{Binding ThreatType}" 
                                                    Width="120"
                                                    FontWeight="Bold"/>
                                <DataGridTextColumn Header="Target" 
                                                    Binding="{Binding Target}" 
                                                    Width="200" 
                                                    FontFamily="Consolas"/>
                                <DataGridTextColumn Header="Action" 
                                                    Binding="{Binding Action}" 
                                                    Width="120"/>
                                <DataGridTextColumn Header="Status" 
                                                    Binding="{Binding Status}" 
                                                    Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                    
                    <!-- System Heatmap -->
                    <GroupBox Grid.Row="2" Header="SYSTEM HEATMAP">
                        <Canvas x:Name="SystemHeatmap" Background="Transparent" Margin="10"/>
                    </GroupBox>
                </Grid>
            </TabItem>
            
            <!-- Live Activity -->
            <TabItem Header="LIVE ACTIVITY">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBox x:Name="LogBox" 
                             Grid.Row="0"
                             IsReadOnly="True" 
                             VerticalScrollBarVisibility="Auto" 
                             HorizontalScrollBarVisibility="Auto"
                             Background="Transparent" 
                             Foreground="{StaticResource AccentSuccess}"
                             FontFamily="Consolas"
                             FontSize="12"
                             BorderThickness="0"
                             Margin="0,0,0,20"/>
                    
                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button x:Name="LiveClearLogButton" Content="ðŸ—‘ï¸ Clear Log" 
                                Style="{StaticResource ModernButton}"
                                Margin="0,0,10,0" 
                                Click="ClearLog_Click"/>
                        <Button x:Name="LiveExportLogButton" Content="ðŸ“¤ Export Log" 
                                Style="{StaticResource ModernButton}"
                                Margin="0,0,10,0" 
                                Click="ExportLog_Click"/>
                        <Button x:Name="LiveOpenLogViewerButton" Content="ðŸ“‹ Log Viewer" 
                                Style="{StaticResource PrimaryButton}"
                                Margin="0,0,10,0" 
                                Click="OpenLogViewer_Click"/>
                        <Button x:Name="LiveStartBehaviorTestButton" Content="ðŸ§ª Start Behavior Test" 
                                Style="{StaticResource SuccessButton}"
                                Margin="0,0,10,0" 
                                Click="StartBehaviorTest_Click"/>
                        <Button x:Name="LiveStopBehaviorTestButton" Content="â¹ï¸ Stop Behavior Test" 
                                Style="{StaticResource WarningButton}"
                                Margin="0,0,10,0" 
                                Click="StopBehaviorTest_Click"/>
                        <Button x:Name="LiveDiagnosticTestButton" Content="ðŸ” Diagnostic Test" 
                                Style="{StaticResource ModernButton}"
                                Click="QuickDiagnosticButton_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- System Monitor -->
            <TabItem Header="SYSTEM MONITOR">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Process List -->
                    <GroupBox Grid.Row="0" Header="MONITORED PROCESSES" Margin="0,0,0,20">
                        <DataGrid x:Name="ProcessGrid" 
                                  Style="{StaticResource ModernDataGrid}"
                                  Height="200">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PID" 
                                                    Binding="{Binding ProcessId}" 
                                                    Width="80" 
                                                    FontFamily="Consolas"/>
                                <DataGridTextColumn Header="Process Name" 
                                                    Binding="{Binding ProcessName}" 
                                                    Width="150"/>
                                <DataGridTextColumn Header="Status" 
                                                    Binding="{Binding Status}" 
                                                    Width="100"/>
                                <DataGridTextColumn Header="Memory (MB)" 
                                                    Binding="{Binding MemoryUsage}" 
                                                    Width="100"/>
                                <DataGridTextColumn Header="CPU %" 
                                                    Binding="{Binding CpuUsage}" 
                                                    Width="80"/>
                                <DataGridTextColumn Header="Threat Level" 
                                                    Binding="{Binding ThreatLevel}" 
                                                    Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                    
                    <!-- System Resources -->
                    <GroupBox Grid.Row="1" Header="SYSTEM RESOURCES">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- CPU Usage Chart -->
                            <Border Grid.Column="0" Style="{StaticResource MetricCard}" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="CPU Usage Over Time" Style="{StaticResource MetricLabel}" Margin="0,0,0,10"/>
                                    <Canvas x:Name="CpuChart" Height="100" Background="Transparent"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Memory Usage Chart -->
                            <Border Grid.Column="1" Style="{StaticResource MetricCard}" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Memory Usage Over Time" Style="{StaticResource MetricLabel}" Margin="0,0,0,10"/>
                                    <Canvas x:Name="MemoryChart" Height="100" Background="Transparent"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>
            
            <!-- Red Team Simulation -->
            <TabItem Header="ðŸ”´ RED TEAM SIMULATION">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Safety Warning -->
                    <Border Grid.Row="0" 
                            Background="#2d1b1b" 
                            BorderBrush="#ff4444" 
                            BorderThickness="2" 
                            CornerRadius="8" 
                            Margin="0,0,0,20" 
                            Padding="20,15">
                        <StackPanel>
                            <TextBlock Text="âš ï¸ RED TEAM SIMULATION WARNING" 
                                       Foreground="#ff6666" 
                                       FontWeight="Bold" 
                                       FontSize="16" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,10"/>
                            <TextBlock Text="This module performs safe attack simulations to test your security controls. All actions are sandboxed and harmless. Only use in test environments." 
                                       Foreground="#ffaaaa" 
                                       TextWrapping="Wrap" 
                                       HorizontalAlignment="Center" 
                                       FontSize="12"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Attack Simulation Controls -->
                    <GroupBox Grid.Row="1" Header="ATTACK SIMULATION CONTROLS" Margin="0,0,0,20">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Quick Attack Buttons -->
                            <WrapPanel Grid.Row="0" HorizontalAlignment="Center" Margin="0,0,0,15">
                                <Button x:Name="CredentialDumpButton" Content="ðŸ” Credential Dump" 
                                        Style="{StaticResource DangerButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="CredentialDumpSimulation_Click"/>
                                
                                <Button x:Name="ProcessHollowingButton" Content="ðŸ§¬ Process Hollowing" 
                                        Style="{StaticResource DangerButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="ProcessHollowingSimulation_Click"/>
                                
                                <Button x:Name="LateralMovementButton" Content="ðŸ”„ Lateral Movement" 
                                        Style="{StaticResource DangerButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="LateralMovementSimulation_Click"/>
                                
                                <Button x:Name="PersistenceButton" Content="ðŸ“Œ Persistence" 
                                        Style="{StaticResource DangerButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="PersistenceSimulation_Click"/>
                                
                                <Button x:Name="RansomwareButton" Content="ðŸ’£ Ransomware" 
                                        Style="{StaticResource DangerButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="RansomwareSimulation_Click"/>
                                
                                <Button x:Name="PhishingButton" Content="ðŸŽ£ Phishing" 
                                        Style="{StaticResource DangerButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="PhishingSimulation_Click"/>
                                
                                <Button x:Name="FullAttackChainButton" Content="âš¡ Full Attack Chain" 
                                        Style="{StaticResource DangerButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="FullAttackChainSimulation_Click"/>
                            </WrapPanel>
                            
                            <!-- Control Buttons -->
                            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button x:Name="StartRedTeamButton" Content="ðŸš€ Start Red Team Agent" 
                                        Style="{StaticResource SuccessButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="StartRedTeamAgent_Click"/>
                                
                                <Button x:Name="StopRedTeamButton" Content="â¹ï¸ Stop Red Team Agent" 
                                        Style="{StaticResource WarningButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="StopRedTeamAgent_Click"/>
                                
                                <Button x:Name="ClearSimulationButton" Content="ðŸ—‘ï¸ Clear Results" 
                                        Style="{StaticResource ModernButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="ClearSimulationResults_Click"/>
                                
                                <Button x:Name="ExportSimulationButton" Content="ðŸ“¤ Export Results" 
                                        Style="{StaticResource ModernButton}"
                                        Padding="20,10" 
                                        Margin="5" 
                                        FontSize="12"
                                        FontWeight="600"
                                        Click="ExportSimulationResults_Click"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Simulation Results -->
                    <Grid Grid.Row="2" Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Attack Results -->
                        <GroupBox Grid.Column="0" Header="ATTACK SIMULATION RESULTS" Margin="0,0,10,0">
                            <DataGrid x:Name="AttackResultsGrid" 
                                      Style="{StaticResource ModernDataGrid}"
                                      Height="200">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Timestamp" 
                                                        Binding="{Binding Timestamp}" 
                                                        Width="120" 
                                                        FontFamily="Consolas"/>
                                    <DataGridTextColumn Header="Attack Type" 
                                                        Binding="{Binding AttackType}" 
                                                        Width="120"
                                                        FontWeight="Bold"/>
                                    <DataGridTextColumn Header="Step" 
                                                        Binding="{Binding Step}" 
                                                        Width="150"/>
                                    <DataGridTextColumn Header="Result" 
                                                        Binding="{Binding Result}" 
                                                        Width="100"/>
                                    <DataGridTextColumn Header="Blocked" 
                                                        Binding="{Binding WasBlocked}" 
                                                        Width="80"/>
                                    <DataGridTextColumn Header="Detected" 
                                                        Binding="{Binding WasDetected}" 
                                                        Width="80"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                        
                        <!-- Security Score -->
                        <GroupBox Grid.Column="1" Header="SECURITY SCORE" Margin="10,0,0,0">
                            <StackPanel Margin="10">
                                <Border Style="{StaticResource MetricCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock x:Name="OverallSecurityScore" Text="100%" 
                                                   Style="{StaticResource MetricValue}" 
                                                   FontSize="36"/>
                                        <TextBlock Text="Overall Security Score" 
                                                   Style="{StaticResource MetricLabel}"/>
                                    </StackPanel>
                                </Border>
                                
                                <StackPanel>
                                    <TextBlock Text="Attack Categories:" 
                                               Foreground="{StaticResource TextSecondary}" 
                                               FontWeight="Bold" 
                                               Margin="0,0,0,10"/>
                                    
                                    <Grid Margin="0,0,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Credential Access" 
                                                   Foreground="{StaticResource TextSecondary}"/>
                                        <TextBlock Grid.Column="1" x:Name="CredentialScore" Text="100%" 
                                                   Foreground="{StaticResource AccentSuccess}" 
                                                   FontWeight="Bold"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Process Exploitation" 
                                                   Foreground="{StaticResource TextSecondary}"/>
                                        <TextBlock Grid.Column="1" x:Name="ExploitationScore" Text="100%" 
                                                   Foreground="{StaticResource AccentSuccess}" 
                                                   FontWeight="Bold"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Lateral Movement" 
                                                   Foreground="{StaticResource TextSecondary}"/>
                                        <TextBlock Grid.Column="1" x:Name="LateralScore" Text="100%" 
                                                   Foreground="{StaticResource AccentSuccess}" 
                                                   FontWeight="Bold"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Persistence" 
                                                   Foreground="{StaticResource TextSecondary}"/>
                                        <TextBlock Grid.Column="1" x:Name="PersistenceScore" Text="100%" 
                                                   Foreground="{StaticResource AccentSuccess}" 
                                                   FontWeight="Bold"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Malware Protection" 
                                                   Foreground="{StaticResource TextSecondary}"/>
                                        <TextBlock Grid.Column="1" x:Name="MalwareScore" Text="100%" 
                                                   Foreground="{StaticResource AccentSuccess}" 
                                                   FontWeight="Bold"/>
                                    </Grid>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                    
                    <!-- Protection Logs -->
                    <GroupBox Grid.Row="3" Header="PROTECTION MODULE LOGS (How Your Security Stopped Attacks)">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBox x:Name="ProtectionLogBox" 
                                     Grid.Row="0"
                                     IsReadOnly="True" 
                                     VerticalScrollBarVisibility="Auto" 
                                     HorizontalScrollBarVisibility="Auto"
                                     Background="Transparent" 
                                     Foreground="{StaticResource AccentSuccess}"
                                     FontFamily="Consolas"
                                     FontSize="11"
                                     BorderThickness="0"
                                     Margin="0,0,0,10"/>
                            
                            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <TextBlock x:Name="ProtectionLogStatus" Text="Ready for simulation..." 
                                           Foreground="{StaticResource TextSecondary}" 
                                           VerticalAlignment="Center" 
                                           Margin="0,0,15,0"/>
                                <Button x:Name="ClearProtectionLogButton" Content="ðŸ—‘ï¸ Clear Log" 
                                        Style="{StaticResource ModernButton}"
                                        Margin="0,0,10,0" 
                                        Click="ClearProtectionLog_Click"/>
                                <Button x:Name="ExportProtectionLogButton" Content="ðŸ“¤ Export Log" 
                                        Style="{StaticResource ModernButton}"
                                        Click="ExportProtectionLog_Click"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>
            
            <!-- Configuration -->
            <TabItem Header="CONFIGURATION">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Control Buttons -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,30">
                        <Button x:Name="StartHuntingButton" Content="ðŸš€ Start Hunting" 
                                Style="{StaticResource SuccessButton}"
                                Padding="30,15" 
                                Margin="0,0,15,0" 
                                Click="StartHunting_Click"/>
                        <Button x:Name="StopHuntingButton" Content="â¹ï¸ Stop Hunting" 
                                Style="{StaticResource WarningButton}"
                                Padding="30,15" 
                                Margin="0,0,15,0" 
                                Click="StopHunting_Click"/>
                        <Button x:Name="SelfDestructButton" Content="ðŸ’¥ Self-Destruct" 
                                Style="{StaticResource DangerButton}"
                                Padding="30,15" 
                                Margin="0,0,15,0"
                                Click="SelfDestruct_Click"/>
                        <Button x:Name="QuickTestEmailButton" Content="ðŸ“§ Test Email" 
                                Style="{StaticResource ModernButton}"
                                Padding="30,15" 
                                Margin="0,0,15,0"
                                Click="TestEmail_Click"/>
                        <Button x:Name="ClearLogButton" Content="ðŸ—‘ï¸ Clear Log" 
                                Style="{StaticResource ModernButton}"
                                Padding="30,15" 
                                Margin="0,0,15,0"
                                Click="ClearLog_Click"/>
                        <Button x:Name="ExportLogButton" Content="ðŸ“¤ Export Log" 
                                Style="{StaticResource ModernButton}"
                                Padding="30,15" 
                                Click="ExportLog_Click"/>
                    </StackPanel>
                    
                    <!-- Module Controls -->
                    <GroupBox Grid.Row="1" Header="MODULE CONTROLS" Margin="0,0,0,20">
                        <WrapPanel Margin="10">
                            <CheckBox x:Name="EnableVirusHunter" Content="Virus Hunter" IsChecked="True"/>
                            <CheckBox x:Name="EnablePayloadReplacer" Content="Payload Replacer" IsChecked="True"/>
                            <CheckBox x:Name="EnableProcessWatcher" Content="Process Watcher" IsChecked="True"/>
                            <CheckBox x:Name="EnableAutorunBlocker" Content="Autorun Blocker" IsChecked="True"/>
                            <CheckBox x:Name="EnableMemoryTrap" Content="Memory Trap" IsChecked="True"/>
                            <CheckBox x:Name="EnableCredentialTrap" Content="Credential Trap" IsChecked="True"/>
                            <CheckBox x:Name="EnableExploitShield" Content="Exploit Shield" IsChecked="True"/>
                            <CheckBox x:Name="EnableWatchdog" Content="Watchdog Core" IsChecked="True"/>
                            <CheckBox x:Name="EnablePhageSync" Content="Phage Sync" IsChecked="True"/>
                            <CheckBox x:Name="EnableHoneyProcess" Content="HoneyProcess" IsChecked="True"/>
                            <CheckBox x:Name="EnableZeroTrustRuntime" Content="ZeroTrustRuntime" IsChecked="True"/>
                            <CheckBox x:Name="EnableDnsSinkhole" Content="DNS Sinkhole" IsChecked="True"/>
                            <CheckBox x:Name="EnablePhishingGuard" Content="PhishingGuard" IsChecked="True"/>
                            <CheckBox x:Name="EnableRollbackEngine" Content="Rollback Engine" IsChecked="True"/>
                            <CheckBox x:Name="EnableAIThreatExplain" Content="AI Threat Explain" IsChecked="True"/>
                        </WrapPanel>
                    </GroupBox>
                    
                    <!-- Email Configuration -->
                    <GroupBox Grid.Row="2" Header="EMAIL REPORTING" Margin="0,0,0,20">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="SMTP Server:" 
                                       Foreground="{StaticResource TextSecondary}" 
                                       VerticalAlignment="Center" 
                                       Margin="0,0,10,0"/>
                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="SmtpServerBox" 
                                     Text="smtp.gmail.com" 
                                     Margin="0,0,20,0"/>
                            
                            <TextBlock Grid.Row="0" Grid.Column="2" Text="Port:" 
                                       Foreground="{StaticResource TextSecondary}" 
                                       VerticalAlignment="Center" 
                                       Margin="0,0,10,0"/>
                            <TextBox Grid.Row="0" Grid.Column="3" x:Name="SmtpPortBox" 
                                     Text="587"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Email:" 
                                       Foreground="{StaticResource TextSecondary}" 
                                       VerticalAlignment="Center" 
                                       Margin="0,0,10,0"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="EmailBox" 
                                     Margin="0,0,20,0"/>
                            
                            <Button Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="2" 
                                    x:Name="TestEmailButton" Content="Test Email" 
                                    Style="{StaticResource ModernButton}"
                                    HorizontalAlignment="Right" 
                                    Click="TestEmail_Click"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Status Display -->
                    <GroupBox Grid.Row="3" Header="SYSTEM STATUS">
                        <StackPanel Margin="10">
                            <TextBlock x:Name="StatusText" Text="System ready..." 
                                       Foreground="{StaticResource TextSecondary}" 
                                       FontSize="12"/>
                            <TextBlock x:Name="EmailStatus" Text="" 
                                       Foreground="{StaticResource AccentWarning}" 
                                       FontSize="12" 
                                       Margin="0,5,0,0" 
                                       Visibility="Collapsed"/>
                            <TextBlock x:Name="LastUpdateTime" Text="" 
                                       Foreground="{StaticResource TextMuted}" 
                                       FontSize="10" 
                                       Margin="0,10,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Command Center -->
            <TabItem Header="COMMAND CENTER">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Endpoint List -->
                    <GroupBox Grid.Row="0" Header="ENDPOINTS (PHAGESYNC MESH)" Margin="0,0,0,20">
                        <DataGrid x:Name="EndpointGrid" 
                                  Style="{StaticResource ModernDataGrid}"
                                  Height="120">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Endpoint" Binding="{Binding NodeId}" Width="200"/>
                                <DataGridTextColumn Header="Last Scan" Binding="{Binding LastScan}" Width="150"/>
                                <DataGridTextColumn Header="Threat Count" Binding="{Binding ThreatCount}" Width="100"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                    
                    <!-- Threat/Status Summary -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,20">
                        <TextBlock Text="Last Scan: " Foreground="{StaticResource TextSecondary}" FontWeight="Bold"/>
                        <TextBlock x:Name="CommandCenterLastScan" Text="-" Foreground="{StaticResource AccentPrimary}" Margin="5,0,20,0"/>
                        <TextBlock Text="Threats: " Foreground="{StaticResource TextSecondary}" FontWeight="Bold"/>
                        <TextBlock x:Name="CommandCenterThreatCount" Text="0" Foreground="{StaticResource AccentDanger}" Margin="5,0,20,0"/>
                        <TextBlock Text="Status: " Foreground="{StaticResource TextSecondary}" FontWeight="Bold"/>
                        <TextBlock x:Name="CommandCenterStatus" Text="Unknown" Foreground="{StaticResource AccentSuccess}"/>
                    </StackPanel>
                    
                    <!-- Secure Admin Shell -->
                    <GroupBox Grid.Row="2" Header="SECURE ADMIN SHELL">
                        <StackPanel>
                            <TextBox x:Name="AdminShellInput" 
                                     Height="30" 
                                     FontFamily="Consolas" 
                                     FontSize="14" 
                                     Margin="0,0,0,10"/>
                            <Button x:Name="AdminShellExecute" 
                                    Content="Execute" 
                                    Style="{StaticResource PrimaryButton}"
                                    Width="100" 
                                    Click="AdminShellExecute_Click"/>
                            <TextBox x:Name="AdminShellOutput" 
                                     Height="100" 
                                     FontFamily="Consolas" 
                                     FontSize="12" 
                                     Foreground="{StaticResource AccentSuccess}" 
                                     Margin="0,10,0,0" 
                                     IsReadOnly="True" 
                                     TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- Status Bar -->
        <Border Grid.Row="4" 
                Background="{StaticResource CardGradient}"
                BorderBrush="{StaticResource BorderPrimary}"
                BorderThickness="0,1,0,0"
                Padding="30,15">
            <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <!-- Status Information -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock x:Name="OverallStatus" Text="ðŸŸ¢ System Protected" 
                               Foreground="{StaticResource AccentSuccess}" 
                               FontWeight="Bold" 
                               Margin="0,0,20,0"/>
                <TextBlock x:Name="UptimeText" Text="Uptime: 00:00:00" 
                               Foreground="{StaticResource TextSecondary}" 
                               FontSize="12"/>
            </StackPanel>
            
            <!-- Quick Actions -->
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button x:Name="RefreshButton" Content="ðŸ”„" 
                            Style="{StaticResource ModernButton}"
                            Width="35" Height="35" 
                            Margin="0,0,10,0" 
                        Click="Refresh_Click"/>
                <Button x:Name="MinimizeButton" Content="ðŸ—•" 
                            Style="{StaticResource ModernButton}"
                            Width="35" Height="35" 
                        Click="Minimize_Click"/>
            </StackPanel>
        </Grid>
        </Border>
    </Grid>
</Window> 